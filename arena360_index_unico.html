<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Arena 360 — Operação (MASTER • arquivo único)</title>
  <style>
  :root{
    --bg:#0d1117; --card:#0f172a; --muted:#94a3b8; --text:#e2e8f0; --accent:#22c55e;
    --line:#1f2937; --chip:#111827; --chip-border:#374151;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--text);font:400 16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu}
  h1{font-size:20px;margin:0 0 2px}
  .subtitle{color:var(--muted);margin:0;font-size:13px}
  .topbar{position:sticky;top:0;z-index:10;display:flex;align-items:center;justify-content:space-between;background:#0b1220;border-bottom:1px solid var(--line);padding:12px 18px}
  .brand{display:flex;align-items:center;gap:12px}
  .logo{display:grid;place-items:center;width:40px;height:40px;border-radius:12px;background:linear-gradient(135deg,#16a34a,#047857);font-weight:700}
  .actions{display:flex;align-items:center;gap:8px}
  .container{max-width:1200px;margin:20px auto;padding:0 12px;display:grid;gap:16px}
  .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:14px}
  .filters .filter-row{display:grid;gap:12px;grid-template-columns:repeat(7, minmax(0,1fr))}
  .filters label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
  .filters input,.filters select{width:100%;padding:10px 12px;border:1px solid var(--line);border-radius:10px;background:#0b1220;color:var(--text);outline:none}
  .table-wrap{overflow:auto;border:1px solid var(--line);border-radius:12px}
  table{width:100%;border-collapse:separate;border-spacing:0;min-width:900px}
  thead th{position:sticky;top:0;background:#0b1220;border-bottom:1px solid var(--line);text-align:left;padding:12px;font-size:13px;color:var(--muted);white-space:nowrap;cursor:pointer}
  thead th.sort-asc::after{content:" \2191";color:var(--accent)}
  thead th.sort-desc::after{content:" \2193";color:var(--accent)}
  tbody td{border-bottom:1px dashed #132035;padding:10px 12px;vertical-align:top;font-size:14px}
  tbody tr:hover{background:#0b1325}
  .pager{display:flex;align-items:center;justify-content:space-between;margin-top:10px}
  .btn{padding:10px 12px;border-radius:10px;border:1px solid var(--chip-border);background:var(--chip);color:var(--text);cursor:pointer}
  .btn:hover{border-color:#4b5563}
  .btn-secondary{background:#0b1220}
  .btn-link{background:transparent;border:none;color:var(--accent);text-decoration:none}
  @media (max-width:960px){
    .filters .filter-row{grid-template-columns:repeat(2,minmax(0,1fr))}
    .actions{gap:6px;flex-wrap:wrap}
  }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">A360</div>
      <div class="titles">
        <h1>Arena 360 — Operação</h1>
        <p class="subtitle">TABELA 1 • Cronograma Diário (MASTER)</p>
      </div>
    </div>
    <nav class="actions">
      <button id="btn-export" class="btn">Exportar CSV</button>
      <button id="btn-print" class="btn btn-secondary">Imprimir</button>
    </nav>
  </header>

  <main class="container">
    <section class="filters card">
      <div class="filter-row">
        <div class="filter-col">
          <label>Buscar</label>
          <input id="q" type="search" placeholder="Tarefa, passos, função, evidência..." autocomplete="off">
        </div>
        <div class="filter-col">
          <label>Bloco</label>
          <select id="f-bloco"><option value="">Todos</option></select>
        </div>
        <div class="filter-col">
          <label>Área</label>
          <select id="f-area"><option value="">Todas</option></select>
        </div>
        <div class="filter-col">
          <label>Função</label>
          <select id="f-func"><option value="">Todas</option></select>
        </div>
        <div class="filter-col">
          <label>Turno</label>
          <select id="f-turno"><option value="">Todos</option></select>
        </div>
        <div class="filter-col">
          <label>Prioridade</label>
          <select id="f-prio"><option value="">Todas</option></select>
        </div>
        <div class="filter-col">
          <label>Status</label>
          <select id="f-status"><option value="">Todos</option></select>
        </div>
      </div>
    </section>

    <section class="card">
      <div class="table-wrap">
        <table id="grid">
          <thead id="grid-head"></thead>
          <tbody id="grid-body"></tbody>
        </table>
      </div>
      <footer class="pager">
        <div class="pager-left">
          <label>Linhas por página</label>
          <select id="page-size">
            <option>25</option>
            <option selected>50</option>
            <option>100</option>
            <option>200</option>
          </select>
        </div>
        <div class="pager-right">
          <button id="prev" class="btn btn-secondary">&larr;</button>
          <span id="page-info"></span>
          <button id="next" class="btn btn-secondary">&rarr;</button>
        </div>
      </footer>
    </section>
  </main>

  <script id="__DATA__" type="application/json">[{"Hora Início": "05:30", "Hora Fim": "05:35", "Duração (min)": 5, "Bloco": "B1 • Pré-abertura (05:00–06:00)", "Turno": "Abertura", "Área": "Aulas", "Função": "Professor (BT/FV)", "Tarefa": "Check-in e preparação pessoal", "Passos (passo a passo)": "Chegar uniformizado; registrar presença na recepção; conferir agenda; receber lista; confirmar quadra/material.", "Critério de Aceite": "Presença marcada; lista em mãos; quadra confirmada.", "Evidência/Registro": "Sistema/Recepção", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "05:30", "Hora Fim": "06:00", "Duração (min)": 30, "Bloco": "B1 • Pré-abertura (05:00–06:00)", "Turno": "Abertura", "Área": "Infra/Limpeza", "Função": "Zelador(a)", "Tarefa": "Abrir vestiários e insumos", "Passos (passo a passo)": "Abrir vestiários; repor papel/sabão/sacos; varrer áreas críticas; conferir lixeiras.", "Critério de Aceite": "Vestiários prontos; insumos repostos.", "Evidência/Registro": "Checklist sanitário", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "05:30", "Hora Fim": "05:40", "Duração (min)": 10, "Bloco": "B1 • Pré-abertura (05:00–06:00)", "Turno": "Abertura", "Área": "Segurança", "Função": "Vigia Noturno", "Tarefa": "Passagem de turno", "Passos (passo a passo)": "Entregar livro à recepção/gerente; comunicar anomalias e providências tomadas.", "Critério de Aceite": "Entrega assinada; itens comunicados.", "Evidência/Registro": "Livro de ocorrências", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "05:30", "Hora Fim": "06:00", "Duração (min)": 30, "Bloco": "B1 • Pré-abertura (05:00–06:00)", "Turno": "Abertura", "Área": "TI/Sistema", "Função": "Suporte TI", "Tarefa": "Checagem de saúde do sistema", "Passos (passo a passo)": "Verificar agendamento/site, POS, internet; testar login; medir velocidade; plano de contingência.", "Critério de Aceite": "Tudo operacional; plano B testado.", "Evidência/Registro": "Log TI", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "05:35", "Hora Fim": "05:45", "Duração (min)": 10, "Bloco": "B1 • Pré-abertura (05:00–06:00)", "Turno": "Abertura", "Área": "Aulas", "Função": "Professor (BT/FV)", "Tarefa": "Montagem de quadra e material", "Passos (passo a passo)": "Ajustar altura da rede; alinhar fitas; separar bolas/cones; montar estações.", "Critério de Aceite": "Rede na altura; linhas visíveis; material completo.", "Evidência/Registro": "Checklist de quadra", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "05:45", "Hora Fim": "05:55", "Duração (min)": 10, "Bloco": "B1 • Pré-abertura (05:00–06:00)", "Turno": "Abertura", "Área": "Aulas", "Função": "Professor (BT/FV)", "Tarefa": "Briefing rápido com recepção", "Passos (passo a passo)": "Alinhar ocupação; no-shows/encaixes; alunos novos e restrições; ajustar plano.", "Critério de Aceite": "Informações confirmadas; plano ajustado.", "Evidência/Registro": "Planilha de turmas", "Prioridade": "Média", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "05:45", "Hora Fim": "06:15", "Duração (min)": 30, "Bloco": "B1 • Pré-abertura (05:00–06:00)", "Turno": "Abertura", "Área": "Gestão", "Função": "Gerente Operacional", "Tarefa": "Auditoria de abertura (3 itens)", "Passos (passo a passo)": "Rota quadras→vestiários→recepção; checar quadras prontas; listas emitidas; limpeza OK; corrigir gaps.", "Critério de Aceite": "3 checks OK; pendências resolvidas.", "Evidência/Registro": "Checklist assinado", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "05:45", "Hora Fim": "06:00", "Duração (min)": 15, "Bloco": "B1 • Pré-abertura (05:00–06:00)", "Turno": "Abertura", "Área": "Quadras", "Função": "Recepcionista / Controle de Acesso", "Tarefa": "Abrir sistema/POS e emitir listas", "Passos (passo a passo)": "Ligar sistema e POS; revisar agenda 06–09; imprimir listas; mapa de quadras; separar pulseiras day-use.", "Critério de Aceite": "Sistema operacional; listas impressas; POS pronto.", "Evidência/Registro": "Log/Impressão", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "05:55", "Hora Fim": "06:00", "Duração (min)": 5, "Bloco": "B1 • Pré-abertura (05:00–06:00)", "Turno": "Abertura", "Área": "Aulas", "Função": "Professor (BT/FV)", "Tarefa": "Pré-aquecimento guiado", "Passos (passo a passo)": "Chamar alunos; mobilidade/ativação; regras de segurança; objetivo da sessão.", "Critério de Aceite": "Aula inicia 06:00; objetivo comunicado.", "Evidência/Registro": "Diário de aula", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "06:00", "Hora Fim": "09:00", "Duração (min)": 180, "Bloco": "B2 • Pico Manhã (06:00–09:00)", "Turno": "Pico Manhã", "Área": "Aulas", "Função": "Professor (BT/FV)", "Tarefa": "Aula — blocos técnico e situacional", "Passos (passo a passo)": "Executar exercícios de fundamento; correções; jogo aplicado; feedback coletivo.", "Critério de Aceite": "Exercícios completos; objetivos atingidos.", "Evidência/Registro": "Observações pós-aula", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "06:00", "Hora Fim": "09:30", "Duração (min)": 210, "Bloco": "B2 • Pico Manhã (06:00–09:00)", "Turno": "Pico Manhã", "Área": "Infra/Limpeza", "Função": "Zelador(a)", "Tarefa": "Suporte a quadras e limpeza de giro", "Passos (passo a passo)": "Nivelar areia; recolher resíduos; varrer muretas; ajustes fitas/redes sob demanda.", "Critério de Aceite": "Quadras prontas; circulação limpa.", "Evidência/Registro": "Checklist de quadra", "Prioridade": "Média", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "06:00", "Hora Fim": "09:00", "Duração (min)": 180, "Bloco": "B2 • Pico Manhã (06:00–09:00)", "Turno": "Pico Manhã", "Área": "Marketing", "Função": "Analista de Marketing / Social Media", "Tarefa": "Cobertura de pico (quando agendado)", "Passos (passo a passo)": "Stories; depoimentos; highlights do bar; feedbacks; repost de alunos.", "Critério de Aceite": "Stories publicados; engajamento alto.", "Evidência/Registro": "IG/TikTok", "Prioridade": "Baixa", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "06:00", "Hora Fim": "09:00", "Duração (min)": 180, "Bloco": "B2 • Pico Manhã (06:00–09:00)", "Turno": "Pico Manhã", "Área": "Quadras", "Função": "Recepcionista / Controle de Acesso", "Tarefa": "Check-in e fila inteligente", "Passos (passo a passo)": "Realizar check-in; registrar no-shows; organizar encaixes; orientar alunos novos; atualizar fila.", "Critério de Aceite": "Check-in <2 min; no-show <5%.", "Evidência/Registro": "Relatório de ocupação", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "08:50", "Hora Fim": "09:00", "Duração (min)": 10, "Bloco": "B2 • Pico Manhã (06:00–09:00)", "Turno": "Pico Manhã", "Área": "Aulas", "Função": "Professor (BT/FV)", "Tarefa": "Fechamento e repasse à recepção", "Passos (passo a passo)": "Alongamento; registrar presenças e no-shows; remarcações; enviar feedback 2 linhas.", "Critério de Aceite": "Presenças registradas; feedback entregue até 09:10.", "Evidência/Registro": "Sistema/Recepção", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "09:00", "Hora Fim": "11:00", "Duração (min)": 120, "Bloco": "B3 • Entre Picos (09:00–17:00)", "Turno": "Semanal", "Área": "Manutenção", "Função": "Técnico de Manutenção Geral", "Tarefa": "Preventiva programada", "Passos (passo a passo)": "Plano semanal por sistemas; checklist de inspeção; priorização de riscos.", "Critério de Aceite": "Checklist assinado; críticos encaminhados.", "Evidência/Registro": "Checklist/OS", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "09:30", "Hora Fim": "15:00", "Duração (min)": 330, "Bloco": "B3 • Entre Picos (09:00–17:00)", "Turno": "Entre-picos", "Área": "Infra/Limpeza", "Função": "Zelador(a)", "Tarefa": "Limpeza geral e reposições", "Passos (passo a passo)": "Limpar áreas comuns e banheiros; lavar pontos críticos; repor insumos; troca de lixeiras.", "Critério de Aceite": "Áreas limpas; sem odores.", "Evidência/Registro": "Checklist limpeza", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "10:00", "Hora Fim": "17:00", "Duração (min)": 420, "Bloco": "B3 • Entre Picos (09:00–17:00)", "Turno": "Entre-picos", "Área": "Comercial", "Função": "Executivo Comercial", "Tarefa": "Implantação de peças de mídia", "Passos (passo a passo)": "Produção/instalação de placas, totens, windbanners; fotos antes/depois; validar posicionamento.", "Critério de Aceite": "Peças instaladas e aprovadas.", "Evidência/Registro": "Fotos/OS", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "10:00", "Hora Fim": "17:00", "Duração (min)": 420, "Bloco": "B3 • Entre Picos (09:00–17:00)", "Turno": "Entre-picos", "Área": "Comercial", "Função": "Executivo Comercial", "Tarefa": "Prospecção ativa", "Passos (passo a passo)": "Mapear leads; cold call; enviar apresentações; agendar reuniões; registrar pipeline.", "Critério de Aceite": "Leads registrados; metas semanais batidas.", "Evidência/Registro": "CRM/Planilha", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "10:00", "Hora Fim": "17:00", "Duração (min)": 420, "Bloco": "B3 • Entre Picos (09:00–17:00)", "Turno": "Entre-picos", "Área": "Comercial", "Função": "Executivo Comercial", "Tarefa": "Relatórios e renovações", "Passos (passo a passo)": "Relatório de entrega (exposição/ativações/fotos); propostas de renovação; negociação.", "Critério de Aceite": "Relatórios enviados; renovação ≥80%.", "Evidência/Registro": "PDF/Email", "Prioridade": "Média", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "10:00", "Hora Fim": "16:00", "Duração (min)": 360, "Bloco": "B3 • Entre Picos (09:00–17:00)", "Turno": "Entre-picos", "Área": "Gestão", "Função": "Gerente Operacional", "Tarefa": "Administração e escala", "Passos (passo a passo)": "Montar/ajustar escala e folgas; fornecedores; revisar DRE; acompanhar indicadores (ocupação, NPS, ticket).", "Critério de Aceite": "Escala publicada; pendências D+1 zeradas.", "Evidência/Registro": "Planilhas/Relatórios", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "10:00", "Hora Fim": "16:00", "Duração (min)": 360, "Bloco": "B3 • Entre Picos (09:00–17:00)", "Turno": "Entre-picos", "Área": "Manutenção", "Função": "Técnico de Manutenção Geral", "Tarefa": "Reparos leves e corretivas", "Passos (passo a passo)": "Atender chamados (rede, iluminação, hidráulica); substituir lâmpadas; revisar bombas.", "Critério de Aceite": "Chamados <24h; 0 quadras indisponíveis em pico.", "Evidência/Registro": "OS/Planilha", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "10:00", "Hora Fim": "17:00", "Duração (min)": 420, "Bloco": "B3 • Entre Picos (09:00–17:00)", "Turno": "Entre-picos", "Área": "Marketing", "Função": "Analista de Marketing / Social Media", "Tarefa": "Planejamento e produção de conteúdo", "Passos (passo a passo)": "Planejar pauta; gravar trechos; editar vídeos; escrever legendas; programar posts e anúncios.", "Critério de Aceite": "Calendário publicado; posts programados.", "Evidência/Registro": "Planner/Meta/IG", "Prioridade": "Média", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "10:00", "Hora Fim": "17:00", "Duração (min)": 420, "Bloco": "B3 • Entre Picos (09:00–17:00)", "Turno": "Entre-picos", "Área": "Quadras", "Função": "Recepcionista / Controle de Acesso", "Tarefa": "Atendimento e reservas", "Passos (passo a passo)": "Responder WhatsApp/telefone; lançar e confirmar reservas; cadastrar clientes; arquivar termos.", "Critério de Aceite": "Tempo resposta <10 min; cadastros completos.", "Evidência/Registro": "Sistema/Termos", "Prioridade": "Média", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "10:00", "Hora Fim": "12:00", "Duração (min)": 120, "Bloco": "B3 • Entre Picos (09:00–17:00)", "Turno": "Entre-picos", "Área": "TI/Sistema", "Função": "Suporte TI", "Tarefa": "Backups e gestão de usuários", "Passos (passo a passo)": "Executar backups; revisar permissões/cadastros; atualizar versões quando seguro.", "Critério de Aceite": "Backup ok; acessos corretos.", "Evidência/Registro": "Relatório TI/Backup", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "16:00", "Hora Fim": "17:00", "Duração (min)": 60, "Bloco": "B3 • Entre Picos (09:00–17:00)", "Turno": "Pré-pico", "Área": "Bar", "Função": "Barman/Caixa/Apoio", "Tarefa": "Mise e preparação de bar", "Passos (passo a passo)": "Abastecer gelo/bebidas; higienizar utensílios; calibrar chopeira; checar validade/PEPS; testar POS.", "Critério de Aceite": "Zero ruptura em pico; POS ok.", "Evidência/Registro": "Checklist de bar", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "16:00", "Hora Fim": "17:00", "Duração (min)": 60, "Bloco": "B3 • Entre Picos (09:00–17:00)", "Turno": "Pré-pico", "Área": "Cozinha", "Função": "Auxiliar de Cozinha", "Tarefa": "Mise en place e pré-preparo", "Passos (passo a passo)": "Porcionar proteínas/guarnições; organizar bancadas; ligar equipamentos; aferir temperaturas; fichas técnicas à vista.", "Critério de Aceite": "Estações montadas; temperaturas corretas.", "Evidência/Registro": "Checklist cozinha", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "17:00", "Hora Fim": "22:00", "Duração (min)": 300, "Bloco": "B4 • Pré-Pico Noite (17:00–18:00)", "Turno": "Pico Noite", "Área": "Bar", "Função": "Barman/Caixa/Apoio", "Tarefa": "Atendimento e venda", "Passos (passo a passo)": "Atender balcão/mesas; conferir idade; lançar comandas; repor insumos; manter balcão limpo.", "Critério de Aceite": "Espera <7 min; zero erros de comanda.", "Evidência/Registro": "POS/Comandas", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "17:00", "Hora Fim": "23:00", "Duração (min)": 360, "Bloco": "B4 • Pré-Pico Noite (17:00–18:00)", "Turno": "Pico Noite", "Área": "Cozinha", "Função": "Auxiliar de Cozinha", "Tarefa": "Execução conforme ficha técnica", "Passos (passo a passo)": "Preparar pedidos respeitando gramagem e tempos; comunicação com bar/recepção; pass limpo.", "Critério de Aceite": "Preparo <12 min; padrão visual ok.", "Evidência/Registro": "Comandas/Pass", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "17:00", "Hora Fim": "23:00", "Duração (min)": 360, "Bloco": "B4 • Pré-Pico Noite (17:00–18:00)", "Turno": "Pico Noite", "Área": "Gestão", "Função": "Gerente Operacional", "Tarefa": "Gestão de pico e incidentes", "Passos (passo a passo)": "Circular entre recepção/bar/quadras; liberar estornos/descontos; resolver incidentes (iluminação, rede, POS).", "Critério de Aceite": "Incidentes <15 min; operação fluida.", "Evidência/Registro": "Livro de ocorrências", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "18:00", "Hora Fim": "21:00", "Duração (min)": 180, "Bloco": "B5 • Pico Noite (18:00–21:00)", "Turno": "Pico Noite", "Área": "Aulas", "Função": "Professor (BT/FV)", "Tarefa": "Aulas/treinos noturnos", "Passos (passo a passo)": "Repetir blocos técnico+situacional; coordenar encaixes/alugueis com recepção.", "Critério de Aceite": "Aulas pontuais; ocupação ≥80%.", "Evidência/Registro": "Plano/observações", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "18:00", "Hora Fim": "21:00", "Duração (min)": 180, "Bloco": "B5 • Pico Noite (18:00–21:00)", "Turno": "Pico Noite", "Área": "Marketing", "Função": "Analista de Marketing / Social Media", "Tarefa": "Cobertura de pico (quando agendado)", "Passos (passo a passo)": "Stories; depoimentos; highlights; captação do movimento; reposts.", "Critério de Aceite": "Stories publicados; engajamento alto.", "Evidência/Registro": "IG/TikTok", "Prioridade": "Baixa", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "22:00", "Hora Fim": "00:00", "Duração (min)": -1320, "Bloco": "B6 • Fechamento (21:00–00:00)", "Turno": "Fechamento", "Área": "Bar", "Função": "Barman/Caixa/Apoio", "Tarefa": "Fechamento de caixa e limpeza", "Passos (passo a passo)": "Emitir Z do POS; contagem rápida de estoque crítico; limpeza de balcão/pias; descarte adequado.", "Critério de Aceite": "Z emitido; área limpa; estoque anotado.", "Evidência/Registro": "POS/Estoque", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "22:00", "Hora Fim": "23:30", "Duração (min)": 90, "Bloco": "B6 • Fechamento (21:00–00:00)", "Turno": "Fechamento", "Área": "Infra/Limpeza", "Função": "Zelador(a)", "Tarefa": "Limpeza de giro final", "Passos (passo a passo)": "Coletar lixo; checar banheiros; varrer; organizar materiais; deixar pronto para 05:30.", "Critério de Aceite": "Ambiente pronto para abertura.", "Evidência/Registro": "Checklist fechamento", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "22:00", "Hora Fim": "22:30", "Duração (min)": 30, "Bloco": "B6 • Fechamento (21:00–00:00)", "Turno": "Fechamento do dia", "Área": "Marketing", "Função": "Analista de Marketing / Social Media", "Tarefa": "Relatório de métricas rápido", "Passos (passo a passo)": "Apurar alcance/cliques/leads; ajustar orçamento de anúncios se necessário.", "Critério de Aceite": "Relatório salvo; aprendizados anotados.", "Evidência/Registro": "Planilha/BI", "Prioridade": "Média", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "22:00", "Hora Fim": "23:30", "Duração (min)": 90, "Bloco": "B6 • Fechamento (21:00–00:00)", "Turno": "Fechamento", "Área": "Quadras", "Função": "Recepcionista / Controle de Acesso", "Tarefa": "Fechar caixa e exportar relatórios", "Passos (passo a passo)": "Emitir Z do POS; conferir sangrias; resolver divergências; exportar CSV; backup em nuvem.", "Critério de Aceite": "0 divergência; arquivos salvos.", "Evidência/Registro": "POS/Backup", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "22:00", "Hora Fim": "06:00", "Duração (min)": -960, "Bloco": "B6 • Fechamento (21:00–00:00)", "Turno": "Madrugada", "Área": "Segurança", "Função": "Vigia Noturno", "Tarefa": "Rondas e proteção patrimonial", "Passos (passo a passo)": "Rondas a cada 60 min; checar portões/cercas/câmeras; verificar desligamentos (refletores, bombas).", "Critério de Aceite": "100% rondas registradas; 0 incidentes sem registro.", "Evidência/Registro": "Livro de ocorrências", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "22:00", "Hora Fim": "23:00", "Duração (min)": 60, "Bloco": "B6 • Fechamento (21:00–00:00)", "Turno": "Fechamento", "Área": "TI/Sistema", "Função": "Suporte TI", "Tarefa": "Backup fim do dia e exportações", "Passos (passo a passo)": "Exportar relatórios (.CSV); validar integridade; armazenar em nuvem.", "Critério de Aceite": "Arquivos íntegros na nuvem.", "Evidência/Registro": "Relatório TI/Drive", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "22:30", "Hora Fim": "23:30", "Duração (min)": 60, "Bloco": "B6 • Fechamento (21:00–00:00)", "Turno": "Fechamento", "Área": "Cozinha", "Função": "Auxiliar de Cozinha", "Tarefa": "Limpeza DDL e descarte", "Passos (passo a passo)": "Desmontar equipamentos; desengordurar; limpar; registrar sobras/perdas; armazenar corretamente.", "Critério de Aceite": "Cozinha limpa; perdas registradas.", "Evidência/Registro": "Planilha perdas/limpeza", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}, {"Hora Início": "22:30", "Hora Fim": "23:30", "Duração (min)": 60, "Bloco": "B6 • Fechamento (21:00–00:00)", "Turno": "Fechamento", "Área": "Gestão", "Função": "Gerente Operacional", "Tarefa": "Consolidação do dia", "Passos (passo a passo)": "Validar fechamentos (recepção e bar); assinar relatórios; comunicar ocorrências e plano D+1.", "Critério de Aceite": "Relatórios assinados; plano D+1 enviado.", "Evidência/Registro": "Relatório diário", "Prioridade": "Alta", "Responsável": "", "Status": "Pendente"}]</script>
  <script id="__OPTS__" type="application/json">{"Bloco": ["B1 • Pré-abertura (05:00–06:00)", "B2 • Pico Manhã (06:00–09:00)", "B3 • Entre Picos (09:00–17:00)", "B4 • Pré-Pico Noite (17:00–18:00)", "B5 • Pico Noite (18:00–21:00)", "B6 • Fechamento (21:00–00:00)"], "Turno": ["Abertura", "Entre-picos", "Fechamento", "Fechamento do dia", "Madrugada", "Pico Manhã", "Pico Noite", "Pré-pico", "Semanal"], "Área": ["Aulas", "Bar", "Comercial", "Cozinha", "Gestão", "Infra/Limpeza", "Manutenção", "Marketing", "Quadras", "Segurança", "TI/Sistema"], "Função": ["Analista de Marketing / Social Media", "Auxiliar de Cozinha", "Barman/Caixa/Apoio", "Executivo Comercial", "Gerente Operacional", "Professor (BT/FV)", "Recepcionista / Controle de Acesso", "Suporte TI", "Técnico de Manutenção Geral", "Vigia Noturno", "Zelador(a)"], "Prioridade": ["Alta", "Baixa", "Média"], "Status": ["Pendente"], "Responsável": []}</script>

  <script>
  const COLUMNS = [
    "Hora Início","Hora Fim","Duração (min)","Bloco","Turno","Área","Função","Tarefa",
    "Passos (passo a passo)","Critério de Aceite","Evidência/Registro","Prioridade",
    "Responsável","Status"
  ].filter(Boolean);
  const DATA = JSON.parse(document.getElementById("__DATA__").textContent || "[]");
  const OPTS = JSON.parse(document.getElementById("__OPTS__").textContent || "{}");

  const state = { data: DATA, page: 1, pageSize: 50, sort: { key: "Hora Início", dir: "asc" },
                  filters: { q: "", bloco: "", area: "", func: "", turno: "", prio: "", status: "" } };

  const els = {
    q: document.getElementById("q"),
    bloco: document.getElementById("f-bloco"),
    area: document.getElementById("f-area"),
    func: document.getElementById("f-func"),
    turno: document.getElementById("f-turno"),
    prio: document.getElementById("f-prio"),
    status: document.getElementById("f-status"),
    pageSize: document.getElementById("page-size"),
    prev: document.getElementById("prev"),
    next: document.getElementById("next"),
    pageInfo: document.getElementById("page-info"),
    head: document.getElementById("grid-head"),
    body: document.getElementById("grid-body"),
    export: document.getElementById("btn-export"),
    print: document.getElementById("btn-print")
  };

  const tr = document.createElement("tr");
  COLUMNS.forEach(col => { const th = document.createElement("th"); th.textContent = col; th.dataset.key = col; th.addEventListener("click", () => onSort(col)); tr.appendChild(th); });
  els.head.appendChild(tr);

  fill(els.bloco, OPTS["Bloco"]);
  fill(els.area,  OPTS["Área"]);
  fill(els.func,  OPTS["Função"]);
  fill(els.turno, OPTS["Turno"]);
  fill(els.prio,  OPTS["Prioridade"]);
  fill(els.status,OPTS["Status"]);

  els.q.addEventListener("input",  () => { state.filters.q = els.q.value.trim().toLowerCase(); state.page=1; render(); });
  els.bloco.addEventListener("change", () => { state.filters.bloco = els.bloco.value; state.page=1; render(); });
  els.area.addEventListener("change",  () => { state.filters.area  = els.area.value; state.page=1; render(); });
  els.func.addEventListener("change",  () => { state.filters.func  = els.func.value; state.page=1; render(); });
  els.turno.addEventListener("change", () => { state.filters.turno = els.turno.value; state.page=1; render(); });
  els.prio.addEventListener("change",  () => { state.filters.prio  = els.prio.value; state.page=1; render(); });
  els.status.addEventListener("change",() => { state.filters.status= els.status.value; state.page=1; render(); });
  els.pageSize.addEventListener("change", () => { state.pageSize = parseInt(els.pageSize.value,10)||50; state.page=1; render(); });
  els.prev.addEventListener("click", () => { if(state.page>1){state.page--; render();} });
  els.next.addEventListener("click", () => { state.page++; render(); });
  els.export.addEventListener("click", onExportCSV);
  els.print.addEventListener("click", () => window.print());

  function fill(sel, items){ if(!sel || !Array.isArray(items)) return; for(const v of items){ const opt = document.createElement("option"); opt.value = v; opt.textContent = v; sel.appendChild(opt); } }
  function onSort(col){ const s = state.sort; if(s.key === col){ s.dir = (s.dir === "asc" ? "desc" : "asc"); }else{ s.key = col; s.dir = "asc"; } updateSortIcons(); render(); }
  function updateSortIcons(){ for(const th of els.head.querySelectorAll("th")){ th.classList.remove("sort-asc","sort-desc"); if(th.dataset.key === state.sort.key){ th.classList.add(state.sort.dir === "asc" ? "sort-asc" : "sort-desc"); } } }
  function getFiltered(){
    const {q, bloco, area, func, turno, prio, status} = state.filters;
    const hasQ = q && q.length>0; const qRe = hasQ ? new RegExp(escapeRegExp(q), "i") : null;
    return state.data.filter(r => {
      if(bloco && r["Bloco"] !== bloco) return false;
      if(area  && r["Área"]  !== area)  return false;
      if(func  && r["Função"]!== func)  return false;
      if(turno && r["Turno"] !== turno) return false;
      if(prio  && r["Prioridade"] !== prio) return false;
      if(status&& r["Status"] !== status) return false;
      if(hasQ){
        const hay = [r["Tarefa"], r["Passos (passo a passo)"], r["Função"], r["Evidência/Registro"], r["Critério de Aceite"], r["Responsável"], r["Área"]].map(v=>String(v||"")).join(" | ");
        if(!qRe.test(hay)) return false;
      }
      return true;
    });
  }
  function render(){
    const filtered = getFiltered();
    const {key, dir} = state.sort;
    filtered.sort((a,b) => cmp(a[key], b[key]) * (dir==="asc" ? 1 : -1));
    const total = filtered.length;
    const pages = Math.max(1, Math.ceil(total / state.pageSize));
    if(state.page > pages) state.page = pages;
    const start = (state.page-1)*state.pageSize;
    const pageRows = filtered.slice(start, start + state.pageSize);
    els.body.innerHTML = "";
    for(const r of pageRows){
      const tr = document.createElement("tr");
      for(const c of COLUMNS){
        const td = document.createElement("td");
        td.textContent = r[c] ?? "";
        tr.appendChild(td);
      }
      els.body.appendChild(tr);
    }
    els.pageInfo.textContent = "Página " + state.page + " de " + pages + " • " + total + " itens";
  }
  function cmp(a,b){
    const tA = parseTime(a), tB = parseTime(b);
    if(tA!=null && tB!=null) return tA - tB;
    const nA = parseFloat(a), nB = parseFloat(b);
    if(!Number.isNaN(nA) && !Number.isNaN(nB)) return nA - nB;
    const sA = String(a||"").toLowerCase(), sB = String(b||"").toLowerCase();
    if(sA < sB) return -1; if(sA > sB) return 1; return 0;
  }
  function parseTime(v){
    if(typeof v!=="string") return null;
    const m = v.match(/^([01]?\d|2[0-3]):([0-5]\d)$/);
    if(!m) return null;
    return parseInt(m[1],10)*60 + parseInt(m[2],10);
  }
  function escapeRegExp(s){
    return s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  }
  function onExportCSV(){
    const rows = getFiltered();
    const cols = COLUMNS;
    let csv = cols.join(";") + "\n";
    for(const r of rows){
      const line = cols.map(c => {
        const val = String(r[c] ?? "").replace(/"/g,'""');
        return /[;\n"]/.test(val) ? "\""+val+"\"" : val;
      }).join(";");
      csv += line + "\n";
    }
    const blob = new Blob([new TextEncoder().encode(csv)], {type: "text/csv;charset=utf-8;"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url; a.download = "arena360_master.csv";
    document.body.appendChild(a); a.click(); a.remove();
    URL.revokeObjectURL(url);
  }
  // start
  render();
  </script>
</body>
</html>
